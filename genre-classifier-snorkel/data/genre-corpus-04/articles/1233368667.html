<!-- <DOCUMENT>
	<FILE>
		1233368667.html
	</FILE>
	<URL>
		http://www-igm.univ-mlv.fr/~lecroq/seqcomp/node1.html#SECTION001
	</URL>
	<TITLE>
		Basic Problem
	</TITLE>
	<GENRE>
		articles
	</GENRE>
	<PLAINTEXT>
 Basic Problem Next: Levenshtein Distance Up: Sequence comparison Previous: Sequence comparison Basic Problem We are interested in the notion of resemblance or similarity between two words x and y of length m and n respectively. A dual notion is to look at the distance between these two words. A word x = x 0 x 1 &#183;&#183;&#183; x m -1 of length m is a sequence of letters from an alphabet . Thus, for 0 i m -1, . The empty word denoted by has a null length: . A function d is a distance between words if: and d ( x , y ) > 0 for all ; ; triangular inequality: . Several distances between words can be considered: the prefix distance: d pref ( x , y ) = | x | + | y | - 2* lcp ( x , y ) where lcp ( x , y ) is the length of the longest common prefix of x and y ; the suffix distance is defined in a similar way as the prefix distance; id. for the substring distance; the Hamming distance. We are interested in a distance which enables to transform x into y using three kinds of basic operations: the substitution of a letter of x by a letter of y , the deletion of a letter of x or the insertion of a letter of y . A cost is associated to each of these operations and for each letter of the alphabet: Sub ( a , b ) is the cost of the substitution of the letter a by the letter b ; Del ( a ) is the cost of the deletion of the letter a ; Ins ( b ) is the cost of the insertion of the letter b . The general problem consists of finding a sequence of such basic operations to transform x into y minimizing the total cost of the operations used. The total cost is equal to the sum of the costs of each of the basic operations. This cost is a distance on the words if Sub is a distance on the letters. We are trying to minimize the distance between x and y which is generally the same (but not always) than maximizing the similarity between these two words. The solution is not necessarily unique. A solution can be given as a sequence of basic operations of substitutions, deletions and insertions. It can also be given in a similar way by an alignment . For two words x of length m and y of length n such as m n . An alignment denoted by or of length p is such that: n p n + m ; or for 0 i p -1 and 0 j m -1; or for 0 i p -1 and 0 j n -1; ; ; for 0 i p -1, such that . An aligned pair of the type with indicates the substitution of the letter a by the letter b . An aligned pair of the type with indicates the deletion of the letter a . An aligned pair of the type with indicates the insertion of the letter b . In an alignement or in an aligned pair, the symbol is often replaced by the symbol -. This problem can be easily stated in terms of graph. Let G = ( V , E ) be a labelled and weighted graph with an application which associates a cost to each edge of E and an application which associates an aligned pair to each edge of E . The graph G is defined as follows: V is the set of vertices defined as follows: E is the set of edges defined as follows: for and and cost (( i -1, j -1),( i , j )) = Sub ( x i , y j ) and ; for and and cost (( i -1, j ),( i , j )) = Del ( x i ) and ; for and and cost (( i , j -1),( i , j )) = Ins ( y j ) and . &#160; Figure 1.1: Edit graph for x = ACGA and y = ATGCTA . All the paths from (-1,-1) to (3,5) correspond to a different alignment between x and y . The thick edges correspond to the following alignment: . It is only necessary to find a shortest path from the vertex (-1,-1) to the vertex ( m -1, n -1). The less the cost the less distant are the two words x and y . As the graph G is acyclic it is possible to find a shortest path considering one time and only one each vertex. One had just to consider them in a topological order. Such an order can be obtained by considering the vertices row by row and from left to right within each row. Dynamic programming ([ 3 ]) can solve this problem. Let T be a two-dimensional table with m +1 rows and n +1 columns. The value of each square T [ i , j ], for -1 i m -1 and -1 j n -1 depends only on the three squares T [ i -1, j ], T [ i , j -1] and T [ i -1, j -1]. Then for 0 i m -1 and 0 j n -1, T [ i , j ] is the minimum cost of a path from (-1,-1) to ( i , j ). The algorithm D YNAMIC -P ROGRAMMING computes all the values of the table T . The algorithm D YNAMIC -P ROGRAMMING clearly has a O ( mn ) time complexity. The algorithm D YNAMIC -P ROGRAMMING only computes the cost of the transformation of x into y . To get a sequence of basic operations to transform x into y or the corresponding alignment one has to trace back in the table T from square T [ m -1, n -1] to square T [-1,-1] taking each time the right edge (see algorithm O NE -A LIGNMENT ). If all the optimal alignments are required then a call to A LL -A LIGNMENT ( x , m -1, y , n -1, , T ) will produced them. In this case it is necessary to store all the values of the table T then this problem can be solve in O ( mn ) space complexity. When only the cost of the transformation of x into y is needed it is easy to see that a space in O (min( m , n )) is sufficient since the computation of a row (respectively a column) only needs the values of the previous row (respectively column). Furthermore it is possible to compute an alignment in linear space using a ``divide and conquer'' method ([ 9 ], [ 11 ] and [ 13 ]). Next: Levenshtein Distance Up: Sequence comparison Previous: Sequence comparison e-mails: { Christian.Charras , Thierry.Lecroq }@laposte.net Thu Feb 19 10:23:29 WET 1998 
	</PLAINTEXT>
	<CONTENT>
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!--Converted with LaTeX2HTML 96.1 (Feb 5, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Basic Problem</TITLE>
<meta name="robots" content="index">
<META NAME="description" CONTENT="Basic Problem">
<META NAME="keywords" CONTENT="sequence alignment">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="align.css">
</HEAD>
<BODY BGCOLOR="white" LANG="EN">
 <A NAME="tex2html20" HREF="node2.html"><IMG BORDER="0" WIDTH=37 HEIGHT=24
  ALIGN=BOTTOM ALT="Levenshtein Distance" SRC="../images/next_motif.gif"></A>
<A NAME="tex2html18" HREF="index.html"><IMG BORDER="0" WIDTH=26 HEIGHT=24
 ALIGN=BOTTOM ALT="Sequence comparison" SRC="../images/up_motif.gif"></A>
<A NAME="tex2html12" HREF="index.html"><IMG BORDER="0" WIDTH=63 HEIGHT=24
 ALIGN=BOTTOM ALT="Sequence comparison" SRC="../images/previous_motif.gif"></A><BR>
<B>Next:</B> <A NAME="tex2html21" HREF="node2.html">Levenshtein Distance</A>
<B>Up:</B> <A NAME="tex2html19" HREF="index.html">Sequence comparison</A>
<B>Previous:</B> <A NAME="tex2html13" HREF="index.html">Sequence comparison</A>
<HR>
<H1><A NAME="SECTION001">Basic Problem</A></H1>
<P>
We are interested in the notion of resemblance or similarity between
 two words <I>x</I> and <I>y</I> of length <I>m</I> and <I>n</I>
 respectively.
A dual notion is to look at the distance between these two words.
<P>
A word
 <I>x</I> =
 <I>x</I><SUB>0</SUB><I>x</I><SUB>1</SUB>&#183;&#183;&#183;<I>x</I><SUB><I>m</I>-1</SUB>
 of length <I>m</I> is a sequence of letters from an alphabet
 <IMG WIDTH=9 HEIGHT=11 ALIGN=BOTTOM ALT="" SRC="img4.gif">.
Thus, for 0 <= <I>i</I> <= <I>m</I>-1, 
 <IMG WIDTH=45 HEIGHT=22 ALIGN=MIDDLE ALT="" SRC="img6.gif">.

<P class="nojustify">
The empty word denoted by
 <IMG WIDTH=4 HEIGHT=7 ALIGN=BOTTOM ALT="" SRC="imglec5.gif">
 has a null length:
 <IMG WIDTH=43 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="imglec6.gif"> .
<P>
A function <I>d</I> is a distance between words if:
<UL>
<LI><IMG WIDTH=159 HEIGHT=23 ALIGN=MIDDLE ALT="" SRC="img7.gif">
 and <I>d</I>(<I>x</I>,<I>y</I>) > 0 for all
 <IMG WIDTH=38 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img8.gif"> ;
<LI><IMG WIDTH=198 HEIGHT=23 ALIGN=MIDDLE ALT="" SRC="img9.gif"> ;
<LI>triangular inequality:
 <IMG WIDTH=281 HEIGHT=23 ALIGN=MIDDLE ALT="" SRC="img10.gif"> .
</UL>
<P>
Several distances between words can be considered:
<UL>
<LI>the prefix distance:
 <I>d<SUB>pref</SUB></I>(<I>x</I>,<I>y</I>) = |<I>x</I>| + |<I>y</I>| -
 2*<I>lcp</I>(<I>x</I>,<I>y</I>)
 where <I>lcp</I>(<I>x</I>,<I>y</I>) is the length of the longest common
 prefix of <I>x</I> and <I>y</I>;
<LI>the suffix distance is defined in a similar way as the prefix
 distance;
<LI>id. for the substring distance;
<LI>the Hamming distance.
</UL>
<P>
We are interested in a distance which enables to transform
 <I>x</I> into <I>y</I> using three kinds of basic operations:
 the <B>substitution</B> of a letter of <I>x</I> by a letter of <I>y</I>,
 the <B>deletion</B> of a letter of <I>x</I> or
 the <B>insertion</B> of a letter of <I>y</I>.
A cost is associated to each of these operations and for each
 letter of the alphabet:
<UL><LI>
 <I>Sub</I>(<I>a</I>,<I>b</I>) is the cost of the substitution of the
 letter <I>a</I> by the letter <I>b</I>;<LI>
<I>Del</I>(<I>a</I>) is the cost of the deletion of the letter <I>a</I>;<LI>
<I>Ins</I>(<I>b</I>) is the cost of the insertion of the letter
 <I>b</I>.
</UL>
<P>
The general problem consists of finding a sequence of such basic
 operations to transform <I>x</I> into <I>y</I> minimizing the total
 cost of the operations used.
The total cost is equal to the sum of the costs of each of the basic
 operations.
This cost is a distance on the words if <I>Sub</I> is a distance on the
 letters.
<P>
We are trying to minimize the distance between <I>x</I> and <I>y</I>
 which is generally the same (but not always) than maximizing the
 similarity between these two words.
<P>
The solution is not necessarily unique.
<P>
A solution can be given as a sequence of basic operations of
 substitutions, deletions and insertions.
It can also be given in a similar way by an <B>alignment</B>.
<P>
For two words <I>x</I> of length <I>m</I> and <I>y</I> of length
 <I>n</I> such as <I>m</I> <= <I>n</I>.
An alignment denoted by
<P>
<IMG WIDTH=372 HEIGHT=40 ALIGN=BOTTOM ALT="" SRC="img17.gif">
<P>
or
<P>
<IMG WIDTH=352 HEIGHT=40 ALIGN=BOTTOM ALT="" SRC="img18.gif">
<P>
 of length <I>p</I> is such that:
<UL><LI>
<I>n</I> <= <I>p</I> <= <I>n</I>+<I>m</I>;<LI>
<IMG WIDTH=52 HEIGHT=21 ALIGN=MIDDLE ALT="" SRC="img20.gif">
 or
 <IMG WIDTH=42 HEIGHT=21 ALIGN=MIDDLE ALT="" SRC="img21.gif">
 for 0 <= <I>i</I> <= <I>p</I>-1 and 0 <= <I>j</I> <= <I>m</I>-1;<LI>
<IMG WIDTH=50 HEIGHT=21 ALIGN=MIDDLE ALT="" SRC="img24.gif">
 or
 <IMG WIDTH=41 HEIGHT=22 ALIGN=MIDDLE ALT="" SRC="img25.gif">
 for 0 <= <I>i</I> <= <I>p</I>-1 and 0 <= <I>j</I> <= <I>n</I>-1;<LI>
<IMG WIDTH=122 HEIGHT=21 ALIGN=MIDDLE ALT="" SRC="img27.gif">;<LI>
<IMG WIDTH=119 HEIGHT=22 ALIGN=MIDDLE ALT="" SRC="img28.gif">;<LI>
for 0 <= <I>i</I> <= <I>p</I>-1,
 <IMG WIDTH=18 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img29.gif">
 such that
 <IMG WIDTH=80 HEIGHT=22 ALIGN=MIDDLE ALT="" SRC="img30.gif">.
</UL>
<P class="nojustify">
An <B>aligned pair</B> of the type
 <IMG WIDTH=18 HEIGHT=29 ALIGN=MIDDLE ALT="" SRC="img31.gif">
 with
 <IMG WIDTH=52 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img32.gif">
 indicates the substitution of the letter <I>a</I> by the letter
 <I>b</I>.
<BR>
An aligned pair of the type
 <IMG WIDTH=18 HEIGHT=29 ALIGN=MIDDLE ALT="" SRC="img33.gif">
 with
 <IMG WIDTH=38 HEIGHT=23 ALIGN=MIDDLE ALT="" SRC="img34.gif">
 indicates the deletion of the letter <I>a</I>.
<BR>
An aligned pair of the type
 <IMG WIDTH=17 HEIGHT=29 ALIGN=MIDDLE ALT="" SRC="img35.gif">
 with
 <IMG WIDTH=36 HEIGHT=25 ALIGN=MIDDLE ALT="" SRC="img36.gif">
 indicates the insertion of the letter <I>b</I>.
<P>
In an alignement or in an aligned pair, the symbol
 <IMG WIDTH=4 HEIGHT=7 ALIGN=BOTTOM ALT="" SRC="img37.gif">
 is often replaced by the symbol -.
<P>
This problem can be easily stated in terms of graph.
Let <I>G</I> = (<I>V</I>,<I>E</I>) be a labelled and weighted graph with
 an application
 <IMG WIDTH=90 HEIGHT=11 ALIGN=BOTTOM ALT="" SRC="img38.gif">
 which associates a cost to each edge of <I>E</I> and an application
 <IMG WIDTH=217 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img39.gif">
 which associates an aligned pair to each edge of <I>E</I>.
The graph <I>G</I> is defined as follows:

<UL><LI>
<I>V</I> is the set of vertices defined as follows:<BR>
<IMG WIDTH=422 HEIGHT=16 ALIGN=BOTTOM ALT="" SRC="img40.gif">
<LI>
<I>E</I> is the set of edges defined as follows:
<BR>
<UL>
<LI><IMG WIDTH=176 HEIGHT=23 ALIGN=MIDDLE ALT="" SRC="img41.gif">
 for
 <IMG WIDTH=92 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img42.gif">
 and
 <IMG WIDTH=89 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img43.gif">
 and
 <I>cost</I>((<I>i</I>-1,<I>j</I>-1),(<I>i</I>,<I>j</I>)) =
 <I>Sub</I>(<I>x<SUB>i</SUB></I>,<I>y<SUB>j</SUB></I>) and
 <IMG WIDTH=231 HEIGHT=30 ALIGN=MIDDLE ALT="" SRC="img45.gif"> ;
 <LI><IMG WIDTH=147 HEIGHT=23 ALIGN=MIDDLE ALT="" SRC="img46.gif">
 for
 <IMG WIDTH=92 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img42.gif">
 and
 <IMG WIDTH=102 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img47.gif">
 and
 <I>cost</I>((<I>i</I>-1,<I>j</I>),(<I>i</I>,<I>j</I>)) =
 <I>Del</I>(<I>x<SUB>i</SUB></I>) and
 <IMG WIDTH=199 HEIGHT=29 ALIGN=MIDDLE ALT="" SRC="img49.gif"> ;
 <LI><IMG WIDTH=147 HEIGHT=23 ALIGN=MIDDLE ALT="" SRC="img50.gif">
 for
 <IMG WIDTH=105 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img51.gif">
 and
 <IMG WIDTH=89 HEIGHT=24 ALIGN=MIDDLE ALT="" SRC="img43.gif"> 
 and
 <I>cost</I>((<I>i</I>,<I>j</I>-1),(<I>i</I>,<I>j</I>)) =
 <I>Ins</I>(<I>y<SUB>j</SUB></I>) and
 <IMG WIDTH=200 HEIGHT=30 ALIGN=MIDDLE ALT="" SRC="img53.gif"> .
</UL></UL>
<DIV align='center'>
<A NAME="1548">&#160;</A>
<BR><IMG WIDTH=606 HEIGHT=350 ALIGN=BOTTOM ALT="figure 1.1" SRC="img54.gif">
<BR>
<STRONG>Figure 1.1:</STRONG>&nbsp;Edit graph for
 <I>x</I> = <TT>ACGA</TT> and <I>y</I> = <TT>ATGCTA</TT>.
 </DIV>
<P>
All the paths from (-1,-1) to (3,5) correspond to a different
 alignment between <I>x</I> and <I>y</I>.
The thick edges correspond to the following alignment:
 <IMG WIDTH=177 HEIGHT=48 ALIGN=MIDDLE ALT="" SRC="img55.gif"> .
<P>
It is only necessary to find a shortest path from the vertex
 (-1,-1) to the vertex (<I>m</I>-1,<I>n</I>-1).
The less the cost the less distant are the two words <I>x</I> and
 <I>y</I>.
As the graph <I>G</I> is acyclic it is possible to find a shortest
 path considering one time and only one each vertex.
One had just to consider them in a topological order.
Such an order can be obtained by considering the vertices row by row
 and from left to right within each row.
Dynamic programming ([<A HREF="node8.html#Bel57">3</A>]) can solve this
 problem.
<P>
Let <I>T</I> be a two-dimensional table with <I>m</I>+1 rows and
 <I>n</I>+1 columns.
The value of each square <I>T</I>[<I>i</I>,<I>j</I>], for
 -1 <= <I>i</I> <= <I>m</I>-1 and -1 <= <I>j</I> <= <I>n</I>-1
 depends only on the three squares
 <I>T</I>[<I>i</I>-1,<I>j</I>], <I>T</I>[<I>i</I>,<I>j</I>-1] and
 <I>T</I>[<I>i</I>-1,<I>j</I>-1].
<P>
Then for
 0 <= <I>i</I> <= <I>m</I>-1 and 0 <= <I>j</I> <= <I>n</I>-1,
 <I>T</I>[<I>i</I>,<I>j</I>] is the
 minimum cost of a path from (-1,-1) to (<I>i</I>,<I>j</I>).
The algorithm
 D<small>YNAMIC</small>-P<small>ROGRAMMING</small>
 computes all the values of the table <I>T</I>.
<P>
<IMG WIDTH=449 HEIGHT=218 ALIGN=BOTTOM ALT="algo 1.1" SRC="img58.gif">
<P>
The algorithm
 D<small>YNAMIC</small>-P<small>ROGRAMMING</small>
 clearly has a <I>O</I>(<I>mn</I>) time complexity.
<P>
The algorithm
 D<small>YNAMIC</small>-P<small>ROGRAMMING</small>
 only computes the cost of the transformation of <I>x</I> into <I>y</I>.
To get a sequence of basic operations to transform <I>x</I> into
 <I>y</I> or
 the corresponding alignment one has to trace back in the table <I>T</I>
 from square <I>T</I>[<I>m</I>-1,<I>n</I>-1] to square <I>T</I>[-1,-1]
 taking each time the right edge (see algorithm
 O<small>NE</small>-A<small>LIGNMENT</small>).
<P>
<IMG WIDTH=372 HEIGHT=423 ALIGN=BOTTOM ALT="algo 1.2" SRC="img59.gif">
<P>
If all the optimal alignments are required then a call to
 A<small>LL</small>-A<small>LIGNMENT</small>(<I>x</I>,
<I>m</I>-1,<I>y</I>,<I>n</I>-1,
 <IMG WIDTH=4 HEIGHT=7 ALIGN=BOTTOM ALT="tex2html_wrap_inline2378" SRC="imglec5.gif">
,<I>T</I>)
 will produced them.
<P>
<IMG WIDTH=538 HEIGHT=266 ALIGN=BOTTOM ALT="algo 1.3" SRC="img60.gif">
<P>
In this case it is necessary to store all the values of the table
 <I>T</I> then this problem can be solve in <I>O</I>(<I>mn</I>) space
 complexity.
<P>
When only the cost of the transformation of <I>x</I> into <I>y</I> is
 needed it is easy to see that a space in
 <I>O</I>(min(<I>m</I>,<I>n</I>)) is sufficient
 since the computation of a row (respectively a column) only needs
 the values of the previous row (respectively column).
<P>
Furthermore it is possible to compute an alignment in linear space
 using a ``divide and conquer'' method
 ([<A HREF="node8.html#Hir75b">9</A>],
  [<A HREF="node8.html#MM88">11</A>] and
  [<A HREF="node8.html#MM88d">13</A>]).
<BR>
<HR>
<A NAME="tex2html20" HREF="node2.html"><IMG BORDER="0" WIDTH=37 HEIGHT=24
  ALIGN=BOTTOM ALT="Levenshtein Distance" SRC="../images/next_motif.gif"></A>
 <A NAME="tex2html18" HREF="index.html"><IMG BORDER="0" WIDTH=26 HEIGHT=24
  ALIGN=BOTTOM ALT="Sequence comparison" SRC="../images/up_motif.gif"></A>
 <A NAME="tex2html12" HREF="index.html"><IMG BORDER="0" WIDTH=63 HEIGHT=24
  ALIGN=BOTTOM ALT="Sequence comparison" SRC="../images/previous_motif.gif"></A><BR>
<B>Next:</B> <A NAME="tex2html21" HREF="node2.html">Levenshtein Distance</A>
<B>Up:</B> <A NAME="tex2html19" HREF="index.html">Sequence comparison</A>
<B>Previous:</B> <A NAME="tex2html13" HREF="index.html">Sequence comparison</A>
<HR>
 e-mails: {<A href="mailto:Christian.Charras@laposte.net">Christian.Charras</A>,
 <A href="mailto:Thierry.Lecroq@laposte.net">Thierry.Lecroq</A>}@laposte.net
<ADDRESS>
<I>Thu Feb 19 10:23:29 WET 1998</I>
</ADDRESS>
</BODY>
</HTML>

